# UAT Test: US-P4.2-006 - Add GAA membership number validation and deduplication

> Auto-generated: 2026-02-15 21:59
> Status: â³ Pending Execution

## Story
As the import system, I need to use GAA membership numbers as the primary deduplication key to prevent duplicate player records.

## Acceptance Criteria Checklist

- [ ] Add to packages/backend/convex/lib/import/deduplicator.ts
- [ ] Add checkGAAMembershipNumber function: (membershipNumber: string) => PlayerIdentity | null
- [ ] Query playerIdentities by externalIds.foireann using index
- [ ] If index doesn't exist, add by_externalIds index to playerIdentities table
- [ ] Validate membership number format: XXX-XXXXX-XXX (3 digits - 5 digits - 3 digits)
- [ ] Return matching player identity if found, null otherwise
- [ ] Update deduplication pipeline to prioritize membership number over name/DOB matching
- [ ] If membership number matches, auto-link with HIGH confidence
- [ ] If no membership number match but name+DOB match, use existing confidence scoring
- [ ] Store membership number in playerIdentities.externalIds.foireann field
- [ ] Run npx -w packages/backend convex codegen

## Playwright E2E Tests
- Run: `npx -w apps/web playwright test --config=uat/playwright.config.ts -g "US-P4.2-006"`
- Report: `npx -w apps/web playwright show-report uat/playwright-report`

## Notes
_Add testing observations here_

---
*Generated by Test Runner Agent*

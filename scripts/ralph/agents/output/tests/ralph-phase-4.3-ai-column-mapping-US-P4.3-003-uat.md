# UAT Test: US-P4.3-003 - Create AI mapping prompt template

> Auto-generated: 2026-02-15 22:33
> Status: â³ Pending Execution

## Story
As a developer, I need a well-engineered prompt template that instructs Claude to map CSV columns to PlayerARC fields with high accuracy.

## Acceptance Criteria Checklist

- [ ] Create packages/backend/convex/lib/import/aiMapper.ts
- [ ] Export buildMappingPrompt function: (columnName, sampleValues, availableFields) => string
- [ ] Prompt structure:
- [ ] 1. System context: 'You are a data mapping expert for a sports player management system.'
- [ ] 2. Task description: 'Map CSV column to target field based on column name and sample values.'
- [ ] 3. Available target fields: firstName, lastName, dateOfBirth, email, phone, address.street1, address.city, address.county, address.postcode, address.country, gender, guardianFirstName, guardianLastName, guardianEmail, guardianPhone
- [ ] 4. Column name: '{columnName}'
- [ ] 5. Sample values: ['{value1}', '{value2}', '{value3}']
- [ ] 6. Instructions: 'Return JSON with targetField (one of available fields or null if no match), confidence (0-100), reasoning (1 sentence explaining your choice).'
- [ ] 7. Examples: 3 example mappings showing high/medium/low confidence cases
- [ ] 8. Constraints: 'Only use provided target fields. Return null if unsure. Be conservative with confidence scores.'
- [ ] Add validation: ensure columnName and sampleValues are provided
- [ ] Run npx ultracite fix

## Playwright E2E Tests
- Run: `npx -w apps/web playwright test --config=uat/playwright.config.ts -g "US-P4.3-003"`
- Report: `npx -w apps/web playwright show-report uat/playwright-report`

## Notes
_Add testing observations here_

---
*Generated by Test Runner Agent*

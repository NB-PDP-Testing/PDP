# UAT Test: US-VN-026 - applyDraft Output Bridge — Parent Summaries, Audit Trail & Backward Compat

> Auto-generated: 2026-02-08 23:19
> Status: ⏳ Pending Execution

## Story
Extend applyDraft to: (1) add back-link fields to voiceNoteInsights, (2) update voiceNotes.insights[] embedded array, (3) schedule processVoiceNoteInsight for parent summaries (with parentSummariesEnabled check), (4) create autoAppliedInsights audit records for auto-confirmed drafts.

## Acceptance Criteria Checklist

- [ ] === FULL DETAILS IN: scripts/ralph/prds/voice-gateways-v2/phases/PHASE7C_PRD.json ===
- [ ] EXECUTION ORDER (CRITICAL):
- [ ] 1. Schema: Make autoAppliedInsights.playerId optional
- [ ] 2. Schema: Add sourceArtifactId/sourceClaimId/sourceDraftId to voiceNoteInsights
- [ ] 3. Run codegen: npx -w packages/backend convex codegen
- [ ] 4. Code: Extend applyDraft with Steps 0-3B
- [ ] 5. Type check: npm run check-types
- [ ] KEY ARCHITECT REVIEW CORRECTIONS:
- [ ] - C1: Check coachOrgPreferences.parentSummariesEnabled BEFORE scheduling processVoiceNoteInsight
- [ ] - C2: Include appliedBy + appliedDate in voiceNotes.insights[] push object
- [ ] - C3: Schema changes FIRST, codegen, then code
- [ ] - S1: Wrap autoAppliedInsights insert (Step 3B) in try/catch

## Playwright E2E Tests
- Run: `npx -w apps/web playwright test --config=uat/playwright.config.ts -g "US-VN-026"`
- Report: `npx -w apps/web playwright show-report uat/playwright-report`

## Notes
_Add testing observations here_

---
*Generated by Test Runner Agent*

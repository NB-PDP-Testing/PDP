# UAT Test: US-P8-023 - Org Admin Trust Gate Status Dashboard

> Auto-generated: 2026-01-27 22:00
> Status: ‚è≥ Pending Execution

## Story
As an organization admin, I want to see the current trust gate status and manage coach overrides so I can control feature access within my organization.

## Acceptance Criteria Checklist

- [ ] Create apps/web/src/app/orgs/[orgId]/settings/features/page.tsx
- [ ] Page structure:
- [ ] - Header: 'Voice Notes Features' with description
- [ ] - Current Status Card:
- [ ] - Trust Gates: ON/OFF badge (org.voiceNotesTrustGatesEnabled)
- [ ] - Admin Control: ENABLED/DISABLED badge (org.allowAdminDelegation)
- [ ] - Coach Overrides: ENABLED/DISABLED badge (org.allowCoachOverrides)
- [ ] - Note: 'Contact platform staff to change these settings'
- [ ] - Admin Blanket Override Card (only if allowAdminDelegation === true):
- [ ] - Title: 'Override for All Coaches'
- [ ] - Description: 'When enabled, all coaches can access features regardless of trust level'
- [ ] - Switch toggle (current state: org.adminOverrideTrustGates)
- [ ] - Info: 'This overrides the organization default for ALL coaches'
- [ ] - Last set by: {adminOverrideSetBy} at {adminOverrideSetAt}
- [ ] - Overview Stats Card:
- [ ] - Total Coaches: {count}
- [ ] - Coaches with Access: {count} ({percentage}%)
- [ ] - Individual Overrides Active: {count}
- [ ] - Pending Override Requests: {count}
- [ ] - Individual Coach Overrides Table (only if allowCoachOverrides === true):
- [ ] Columns:
- [ ] - Coach Name
- [ ] - Trust Level (Badge: 0/1/2+)
- [ ] - Override Status (Badge: ACTIVE/NONE)
- [ ] - Reason (from overrideReason)
- [ ] - Granted By (admin name)
- [ ] - Granted At (timestamp)
- [ ] - Expires At (if set, show countdown)
- [ ] - Actions (Revoke button)
- [ ] - Pending Override Requests Section (only if allowCoachOverrides === true):
- [ ] Columns:
- [ ] - Coach Name
- [ ] - Trust Level
- [ ] - Reason (coach's justification)
- [ ] - Requested At
- [ ] - Actions (Approve / Deny buttons with reason input modal)
- [ ] Use query: api.models.trustGatePermissions.getOrgFeatureFlagStatus with { organizationId: orgId }
- [ ] Use query: api.models.trustGatePermissions.getCoachOverrideRequests with { organizationId: orgId, status: 'pending' }
- [ ] Mutation handlers:
- [ ] - Toggle blanket override: Call setAdminBlanketOverride
- [ ] - Grant override: Call grantCoachOverride (from request or manual)
- [ ] - Revoke override: Call revokeCoachOverride
- [ ] - Approve request: Call reviewCoachOverrideRequest with approved: true
- [ ] - Deny request: Call reviewCoachOverrideRequest with approved: false
- [ ] Auth guard: Only visible to organization admins (role: 'admin' or 'owner')
- [ ] Add navigation link in org settings sidebar under 'Features'
- [ ] Type check passes: npm run check-types
- [ ] Visual verification:
- [ ] - Admin sees current status correctly
- [ ] - Blanket override toggle works (if delegation enabled)
- [ ] - Individual overrides display correctly
- [ ] - Pending requests show with approve/deny actions

## Test Scenarios

### Happy Path
1. Navigate to the feature
2. Perform the primary action described in the story
3. Verify all acceptance criteria are met
4. **Expected:** Feature works as described

### Edge Cases
1. Test with empty/null values
2. Test with boundary values
3. Test rapid repeated actions
4. **Expected:** Graceful handling, no errors

### Error Handling
1. Test with invalid inputs
2. Test without proper permissions
3. Test with network issues (if applicable)
4. **Expected:** Clear error messages, no crashes

## Visual Verification
- [ ] UI matches design expectations
- [ ] Responsive on mobile (if applicable)
- [ ] Loading states are appropriate
- [ ] Error states are user-friendly

## Notes
_Add testing observations here_

---
*Generated by Test Runner Agent*

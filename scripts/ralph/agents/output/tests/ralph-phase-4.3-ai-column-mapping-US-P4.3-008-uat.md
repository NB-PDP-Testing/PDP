# UAT Test: US-P4.3-008 - Add AI mapping analytics and monitoring

> Auto-generated: 2026-02-15 22:42
> Status: ‚è≥ Pending Execution

## Story
As a platform admin, I need to monitor AI mapping performance (accuracy, cache hit rate, costs) to optimize the system.

## Acceptance Criteria Checklist

- [ ] Create packages/backend/convex/models/aiMappingAnalytics.ts
- [ ] Implement trackAIMappingUsage mutation: logs each AI mapping call
- [ ] Fields: timestamp, columnName, cached (boolean), confidence, accepted (boolean), correctedTo (string if rejected)
- [ ] Add index: by_timestamp for time-based queries
- [ ] Implement getAIMappingStats query: returns analytics for date range
- [ ] Stats: totalMappings, cacheHitRate, avgConfidence, acceptanceRate, topCorrectedMappings
- [ ] Implement getAICostEstimate query: estimates API costs based on usage
- [ ] Cost calculation: uncached mappings * $0.003 per request (Sonnet pricing)
- [ ] Add cache cleanup mutation: deletes expired cache entries older than 30 days
- [ ] Schedule cache cleanup in crons.ts: run daily at 2 AM
- [ ] Run npx -w packages/backend convex codegen

## Playwright E2E Tests
- Run: `npx -w apps/web playwright test --config=uat/playwright.config.ts -g "US-P4.3-008"`
- Report: `npx -w apps/web playwright show-report uat/playwright-report`

## Notes
_Add testing observations here_

---
*Generated by Test Runner Agent*

# Ralph Progress Log
Started: Fri 13 Feb 2026 23:21:35 GMT
---

## Codebase Patterns
**Last Updated**: 2026-02-13 23:30 - Iteration 1

### Architecture
- All routes scoped under `/orgs/[orgId]/`
- Better Auth for authentication, Convex for backend
- Organization data isolated via organizationId field
- Turborepo monorepo: `apps/web/` (Next.js 14), `packages/backend/` (Convex)

### Convex Backend Patterns
- NEVER use `.filter()` - always use `.withIndex()`
- All functions need `args` and `returns` validators
- Use `Id<"tableName">` types, not `string`
- Index names include all fields: `by_orgId_and_status`
- Auth check: `requireOrgAdmin` pattern in importSessions.ts for admin-only mutations
- Use HARD DELETE (ctx.db.delete) - no soft delete pattern in this codebase

### Frontend Patterns
- Use shadcn/ui components from `@/components/ui`
- Use `useSearchParams` for filter state (URL persistence)
- Organization theming via CSS variables: `--org-primary`, etc.
- Admin pages: `apps/web/src/app/orgs/[orgId]/admin/`
- Import components: `apps/web/src/components/import/`

### Import System (Phase 2.4 Context)
- All 6 import tables have `importSessionId` field + `by_importSessionId` index
- Tables: playerIdentities, guardianIdentities, guardianPlayerLinks, orgPlayerEnrollments, sportPassports, skillAssessments
- Import sessions track state with status transitions in VALID_TRANSITIONS map
- Schema already has 'undone' status literal + undo audit fields (undoneAt, undoneBy, undoReason)

### Quality Checks
- Run in order: `npm run check-types` → `npx ultracite fix` → `npm run check`
- Ultracite must run before linting or you'll get false failures
- For frontend changes: test in browser at http://localhost:3000
- Codegen: `npx -w packages/backend convex codegen`

---

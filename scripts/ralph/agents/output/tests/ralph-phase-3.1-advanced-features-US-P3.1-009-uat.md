# UAT Test: US-P3.1-009 - Create platform staff analytics backend queries

> Auto-generated: 2026-02-14 23:57
> Status: ‚è≥ Pending Execution

## Story
As platform staff, I need backend queries to fetch cross-org import analytics so I can monitor platform health and identify systemic issues.

## Acceptance Criteria Checklist

- [ ] Create importAnalytics.ts in packages/backend/convex/models/
- [ ] Add getPlatformImportAnalytics query (platform staff only):
- [ ] - Total imports across all orgs (last 30 days, last 90 days, all time)
- [ ] - Success rate: (successful imports / total imports) * 100
- [ ] - Average players per import
- [ ] - Total players imported platform-wide
- [ ] - Common error types with counts
- [ ] Add getOrgImportHistory query (org admins + platform staff):
- [ ] - Org-specific import list with dates, player counts, status
- [ ] - Success/failure breakdown
- [ ] - Template usage statistics
- [ ] Add getCommonErrors query (platform staff only):
- [ ] - Aggregated error messages across all imports
- [ ] - Error frequency counts
- [ ] - Top 10 most common errors
- [ ] Add by_organizationId and by_createdAt indexes to importSessions
- [ ] Use .withIndex() for all queries - NEVER .filter()
- [ ] Return validators for all queries with v.object() schemas
- [ ] Run npx -w packages/backend convex codegen after completion
- [ ] Run npx ultracite fix before completion

## Playwright E2E Tests
- Run: `npx -w apps/web playwright test --config=uat/playwright.config.ts -g "US-P3.1-009"`
- Report: `npx -w apps/web playwright show-report uat/playwright-report`

## Notes
_Add testing observations here_

---
*Generated by Test Runner Agent*

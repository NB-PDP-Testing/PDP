# UAT Test: US-VN-024 - Drafts Tab in Voice Notes Dashboard

> Auto-generated: 2026-02-08 21:57
> Status: ⏳ Pending Execution

## Story
Add a new 'Drafts' tab to the voice notes dashboard that shows pending v2 insight drafts. Each draft shows title, description, resolved player name, confidence score, and evidence transcript snippet. Coaches can confirm or reject individual drafts. The tab shows a count badge when drafts are pending.

## Acceptance Criteria Checklist

- [ ] === FULL IMPLEMENTATION DETAILS IN: scripts/ralph/prds/voice-gateways-v2/phases/PHASE7B_PRD.json ===
- [ ] Read that file for exact line numbers, verified function signatures, and step-by-step code.
- [ ] SUMMARY:
- [ ] 1. voice-notes-dashboard.tsx — Add 'drafts' to TabId union type (line 63-70)
- [ ] 2. voice-notes-dashboard.tsx — Add pendingDrafts useQuery near existing queries (line 95+):
- [ ] useQuery(api.models.insightDrafts.getPendingDraftsForCoach, coachId ? { organizationId: orgId } : 'skip')
- [ ] 3. voice-notes-dashboard.tsx — Add Drafts tab to tabs builder (line 409+) AFTER insights BEFORE team:
- [ ] { id: 'drafts', label: 'Drafts', icon: FileCheck, badge: pendingDrafts?.length || undefined }
- [ ] NOTE: Drafts tab should ALWAYS show (not conditional) — empty state handles no-drafts
- [ ] 4. voice-notes-dashboard.tsx — Add DraftsTab rendering (line 764, between insights and team)
- [ ] 5. CREATE: components/drafts-tab.tsx — New component with:
- [ ] - Props: { orgId: string; pendingDrafts: Draft[] } (data passed from parent, NOT queried inside)
- [ ] - Group drafts by artifactId using Map
- [ ] - Each draft card: title, description, player name badge, insight type badge (colored), confidence bar, evidence snippet (collapsible)
- [ ] - Actions: Confirm button (green) → confirmDraft, Reject button (red outline) → rejectDraft
- [ ] - Loading/disabled state during mutations
- [ ] - Toast on success/error (sonner)
- [ ] - Empty state: FileCheck icon + 'No pending drafts' message
- [ ] - Skeleton cards while data loading
- [ ] CRITICAL: Import + usage in SAME edit
- [ ] CRITICAL: useQuery in parent dashboard only — pass data as props to DraftsTab
- [ ] CRITICAL: Use useMutation (NOT useAction) for confirm/reject
- [ ] Confidence bar colors: red < 0.6, amber 0.6-0.8, green > 0.8
- [ ] Insight type badge colors: injury=red, wellbeing=amber, skill_rating=blue, attendance=purple,
- [ ] behavior=orange, performance=green, development_milestone=teal, note=gray
- [ ] === VERIFY ===
- [ ] Type check: npm run check-types
- [ ] Build: npm run build
- [ ] Dashboard loads without errors, Drafts tab visible with FileCheck icon

## Playwright E2E Tests
- Run: `npx -w apps/web playwright test --config=uat/playwright.config.ts -g "US-VN-024"`
- Report: `npx -w apps/web playwright show-report uat/playwright-report`

## Notes
_Add testing observations here_

---
*Generated by Test Runner Agent*

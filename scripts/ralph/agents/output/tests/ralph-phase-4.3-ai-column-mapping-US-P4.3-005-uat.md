# UAT Test: US-P4.3-005 - Create batch AI mapping orchestrator

> Auto-generated: 2026-02-15 22:36
> Status: ⏳ Pending Execution

## Story
As the import system, I need to suggest mappings for all CSV columns at once to minimize latency and provide a complete suggestion set.

## Acceptance Criteria Checklist

- [ ] Add to packages/backend/convex/actions/aiMapping.ts
- [ ] Implement suggestAllMappings action with args: columns (array of { name, sampleValues })
- [ ] Call suggestColumnMapping for each column in parallel (use Promise.all)
- [ ] Return: { mappings: Record<columnName, AIMappingResult>, cacheHitRate: number }
- [ ] cacheHitRate = (cached / total) * 100 for monitoring
- [ ] Add rate limiting: max 10 concurrent API calls to avoid overwhelming Claude API
- [ ] If rate limit hit (429), use exponential backoff and retry
- [ ] Sort results by confidence: HIGH → MEDIUM → LOW for UI display
- [ ] Add TypeScript types: BatchMappingRequest, BatchMappingResult
- [ ] Run npx ultracite fix and npm run check-types

## Playwright E2E Tests
- Run: `npx -w apps/web playwright test --config=uat/playwright.config.ts -g "US-P4.3-005"`
- Report: `npx -w apps/web playwright show-report uat/playwright-report`

## Notes
_Add testing observations here_

---
*Generated by Test Runner Agent*

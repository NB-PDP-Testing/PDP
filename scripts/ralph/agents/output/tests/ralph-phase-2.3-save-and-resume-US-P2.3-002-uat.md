# UAT Test: US-P2.3-002 - Create draft persistence mutations and query

> Auto-generated: 2026-02-13 21:55
> Status: ‚è≥ Pending Execution

## Story
As the import system, I need mutations to save and delete drafts, and a query to load the most recent draft.

## Acceptance Criteria Checklist

- [ ] Create packages/backend/convex/models/importSessionDrafts.ts
- [ ] saveDraft mutation: upserts draft by userId + organizationId (delete old draft first, then insert new). Sets expiresAt to 7 days from now. Requires auth check.
- [ ] loadDraft query (NOT mutation): finds most recent non-expired draft for userId + organizationId using by_userId_and_orgId index. Returns null if no draft exists.
- [ ] deleteDraft mutation: deletes draft by ID. Requires auth check.
- [ ] listExpiredDrafts internalQuery: finds drafts where expiresAt < Date.now() using by_expiresAt index, returns up to 100 at a time
- [ ] cleanupExpiredDrafts internalMutation: calls listExpiredDrafts and deletes them in batch
- [ ] Include args and returns validators on all functions
- [ ] Auth check on saveDraft and deleteDraft: verify user is authenticated via authComponent.getAuthUser
- [ ] Run npx ultracite fix and npx -w packages/backend convex codegen

## Playwright E2E Tests
- Run: `npx -w apps/web playwright test --config=uat/playwright.config.ts -g "US-P2.3-002"`
- Report: `npx -w apps/web playwright show-report uat/playwright-report`

## Notes
_Add testing observations here_

---
*Generated by Test Runner Agent*

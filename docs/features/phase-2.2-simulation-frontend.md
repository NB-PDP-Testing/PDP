# PlayerARC - Phase 2.2: Import Simulation Frontend

> Auto-generated documentation - Last updated: 2026-02-13 21:04

## Status

- **Branch**: `ralph/phase-2.2-simulation-frontend`
- **Progress**: 3 / 3 stories complete
- **Phase Status**: âœ… Complete

## Completed Features

### US-P2.2-001: Create SimulationResults display component

As an admin reviewing an import, I need to see a dry-run preview showing exactly what will be created, updated, or linked.

**Acceptance Criteria:**
- Create apps/web/src/components/import/simulation-results.tsx
- Summary stats grid showing: Players to Create, Players to Update, Guardians to Create, Guardians to Link, Enrollments to Create, Passports to Create, Benchmarks to Apply
- Each stat shown as a Card with large number and descriptive label
- Stats cards color-coded: creates in green, updates in blue, links in purple
- Sample player cards section: show up to 5 player previews from playerPreviews array
- Each player card shows: name, DOB, age group, action badge (Create/Update), guardian info if present
- Warnings section: show any warnings from the simulation (amber Alert components)
- Errors section: show any errors from the simulation (red Alert components)
- Component accepts props: simulationResult (from simulate query), onProceed, onBack, isLoading
- Use shadcn/ui Card, Badge, Alert, Button, Skeleton (for loading state) components
- Mobile responsive: 1-column layout at 375px, 2-column at md breakpoint

### US-P2.2-002: Integrate simulation into wizard review step

As an admin in the import wizard, I need to run a simulation from the review step and see the preview before committing to the live import.

**Acceptance Criteria:**
- Update review-step.tsx to include a 'Run Simulation' button
- On click, call the simulate query via useQuery with the current wizard data (organizationId, sportCode, players, selectedRowIndices, benchmarkSettings)
- Use query skipping: pass 'skip' to useQuery until user clicks Run Simulation
- Show loading skeleton while simulation is running
- On success, show SimulationResults component with the results
- On error, show error Alert with retry button
- SimulationResults 'Proceed to Import' button transitions to the import step
- If simulation shows errors (result.errors.length > 0), disable proceed and show 'Fix errors before importing'
- Back button returns to quality check or selection step
- Transform wizard state into the simulate query's expected args shape (match the v.array(v.object({...})) from importSimulation.ts)
- Run npx ultracite fix and npm run check-types

### US-P2.2-003: Polish simulation UX and edge cases

As an admin, I need the simulation flow to handle edge cases gracefully and feel polished.

**Acceptance Criteria:**
- Show estimated time if simulation takes >2 seconds (based on row count)
- If no rows are selected, show empty state instead of running simulation
- If wizard data hasn't changed since last simulation, show cached results instead of re-running
- Add a 'Re-run Simulation' button if user goes back and changes data, then returns
- Simulation results persist in wizard state so navigating back and forward doesn't lose them
- Clear simulation results when underlying data changes (mappings, selections, benchmark settings)
- Run npx ultracite fix and npm run check-types


## Implementation Notes

### Key Patterns & Learnings


## Key Files


---
*Documentation auto-generated by Ralph Documenter Agent*

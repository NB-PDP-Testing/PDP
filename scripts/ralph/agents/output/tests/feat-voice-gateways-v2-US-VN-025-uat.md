# UAT Test: US-VN-025 - Draft Batch Operations & Auto-Switch to Drafts Tab

> Auto-generated: 2026-02-08 22:05
> Status: ⏳ Pending Execution

## Story
Add batch confirm/reject operations to the Drafts tab (Confirm All, Reject All per artifact group). Wire auto-switch to Drafts tab when pending drafts exist. Verify DisambiguationBanner works with in-app artifacts.

## Acceptance Criteria Checklist

- [ ] === FULL IMPLEMENTATION DETAILS IN: scripts/ralph/prds/voice-gateways-v2/phases/PHASE7B_PRD.json ===
- [ ] Read that file for exact implementation instructions.
- [ ] SUMMARY:
- [ ] 1. components/drafts-tab.tsx — Add batch operations per artifact group:
- [ ] - Group header: date, 'N pending insights' count, batch action buttons right-aligned
- [ ] - 'Confirm All (N)' button (green) → confirmAllDrafts({ artifactId })
- [ ] NOTE: artifactId is v.id('voiceNoteArtifacts') — the Convex _id from draft.artifactId
- [ ] - 'Reject All (N)' button (red outline) → shows AlertDialog confirmation FIRST, then rejectAllDrafts({ artifactId })
- [ ] - Loading/disabled state on both batch buttons during mutation
- [ ] - Toast: 'Confirmed N insights' / 'Rejected N insights'
- [ ] 2. voice-notes-dashboard.tsx — Auto-switch to Drafts tab (modify useEffect at line 167-177):
- [ ] Priority: parents (most urgent) > drafts (needs review) > insights
- [ ] Add: else if ((pendingDrafts?.length ?? 0) > 0) { setActiveTab('drafts'); setHasAutoSwitched(true); }
- [ ] Add pendingDrafts to useEffect dependency array
- [ ] 3. Verify disambiguation-banner.tsx works with in-app artifacts:
- [ ] Already imported (line 53) and rendered (line 595)
- [ ] Does NOT filter by sourceChannel — should work automatically
- [ ] If it doesn't show: check getDisambiguationQueue returns for in-app artifacts
- [ ] === VERIFY ===
- [ ] Type check: npm run check-types
- [ ] Build: npm run build
- [ ] 'Confirm All' confirms all drafts in group + toast
- [ ] 'Reject All' shows AlertDialog → confirm → all rejected + toast
- [ ] Auto-switch: dashboard opens to Drafts tab when pending drafts exist
- [ ] DisambiguationBanner appears when in-app note has ambiguous entity resolution

## Playwright E2E Tests
- Run: `npx -w apps/web playwright test --config=uat/playwright.config.ts -g "US-VN-025"`
- Report: `npx -w apps/web playwright show-report uat/playwright-report`

## Notes
_Add testing observations here_

---
*Generated by Test Runner Agent*
